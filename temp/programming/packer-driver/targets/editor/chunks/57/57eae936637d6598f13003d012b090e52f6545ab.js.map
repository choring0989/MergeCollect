{"version":3,"sources":["file:///C:/Users/%EC%9D%B4%EC%A7%80%EC%95%88/Documents/GitHub/MergeCollect/assets/script/BlockFactory.ts"],"names":["_decorator","Block","MapData","ObjectFactory","ccclass","property","BlockFactory","constructor","blockLayer","map","blocks","Array","start","createMap","mapSetting","setting","id","pivotX","centerPivotX","maxRow","pivotY","centerPivotY","maxCol","currentMap","getMapFromID","k","i","row","j","col","blockData","currentMapData","block","get","setPosition","addChild","push","getComponent"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;;AACAC,MAAAA,K,iBAAAA,K;;AACAC,MAAAA,O,iBAAAA,O;;AACAC,MAAAA,a,iBAAAA,a;;;;;;;;;OACH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBL,U;;8BAGjBM,Y,WADZF,OAAO,CAAC,cAAD,C,gBAAR,MACaE,YADb,CAC0B;AAKtBC,QAAAA,WAAW,CAACC,UAAD,EAAmB;AAAA,eAJtBA,UAIsB,GAJH,IAIG;AAAA,eAHtBC,GAGsB;AAAA,eAFtBC,MAEsB;AAC1B,eAAKF,UAAL,GAAkBA,UAAlB;AACA,eAAKE,MAAL,GAAc,IAAIC,KAAJ,EAAd;AACA,eAAKC,KAAL;AACH;;AAEDA,QAAAA,KAAK,GAAG;AACJ,eAAKH,GAAL,GAAW;AAAA;AAAA,mCAAX;AACA,eAAKI,SAAL,CAAe,GAAf;AACH;;AAEa,YAAVC,UAAU,GAAG;AACb,iBAAO,KAAKL,GAAL,CAASM,OAAhB;AACH;;AAEDF,QAAAA,SAAS,CAACG,EAAD,EAAK;AACV,gBAAMC,MAAM,GAAG,KAAKH,UAAL,CAAgBI,YAAhB,GAAgC,KAAKJ,UAAL,CAAgBK,MAAhB,GAAyB,CAAxE;AACA,gBAAMC,MAAM,GAAG,KAAKN,UAAL,CAAgBO,YAAhB,GAAgC,KAAKP,UAAL,CAAgBQ,MAAhB,GAAyB,CAAxE;AACA,gBAAMC,UAAU,GAAG,KAAKd,GAAL,CAASe,YAAT,CAAsBR,EAAtB,CAAnB;AACA,cAAIS,CAAC,GAAG,CAAR;;AAEA,eAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGH,UAAU,CAACI,GAA/B,EAAoCD,CAAC,EAArC,EAAyC;AACrC,iBAAK,IAAIE,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGL,UAAU,CAACM,GAA/B,EAAoCD,CAAC,EAArC,EAAyC;AACrC,kBAAIE,SAAS,GAAG,KAAKrB,GAAL,CAASsB,cAAT,GAA0BN,CAA1B,CAAhB;;AACA,kBAAIK,SAAS,CAAC,CAAD,CAAT,KAAiBL,CAArB,EAAwB;AACpB,sBAAMO,KAAK,GAAG;AAAA;AAAA,oDAAcC,GAAd,CAAkBH,SAAS,CAAC,CAAD,CAA3B,CAAd;AACAE,gBAAAA,KAAK,CAACE,WAAN,CAAkBjB,MAAM,GAAGS,CAA3B,EAA8B,CAA9B,EAAiCN,MAAM,GAAGQ,CAA1C;AACA,qBAAKpB,UAAL,CAAgB2B,QAAhB,CAAyBH,KAAzB;AACA,qBAAKtB,MAAL,CAAY0B,IAAZ,CAAiBJ,KAAK,CAACK,YAAN;AAAA;AAAA,mCAAjB;AACH;;AACDZ,cAAAA,CAAC;AACJ;AACJ;AACJ;;AAtCqB,O","sourcesContent":["import { _decorator, Node, instantiate } from 'cc';\r\nimport { Block } from './Block';\r\nimport { MapData } from './MapData';\r\nimport { ObjectFactory } from './ObjectFactory';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('BlockFactory')\r\nexport class BlockFactory {\r\n    private blockLayer: Node = null;\r\n    private map: MapData;\r\n    private blocks: Block[];\r\n\r\n    constructor(blockLayer: Node) {\r\n        this.blockLayer = blockLayer;\r\n        this.blocks = new Array<Block>();\r\n        this.start();\r\n    }\r\n\r\n    start() {\r\n        this.map = new MapData();\r\n        this.createMap('1');\r\n    }\r\n\r\n    get mapSetting() {\r\n        return this.map.setting;\r\n    }\r\n\r\n    createMap(id) {\r\n        const pivotX = this.mapSetting.centerPivotX - (this.mapSetting.maxRow / 2);\r\n        const pivotY = this.mapSetting.centerPivotY - (this.mapSetting.maxCol / 2);\r\n        const currentMap = this.map.getMapFromID(id);\r\n        let k = 0;\r\n\r\n        for (let i = 0; i < currentMap.row; i++) {\r\n            for (let j = 0; j < currentMap.col; j++) {\r\n                let blockData = this.map.currentMapData()[k];\r\n                if (blockData[1] === k) {\r\n                    const block = ObjectFactory.get(blockData[0]);\r\n                    block.setPosition(pivotX + i, 0, pivotY + j);\r\n                    this.blockLayer.addChild(block);\r\n                    this.blocks.push(block.getComponent(Block));\r\n                }\r\n                k++;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n"]}